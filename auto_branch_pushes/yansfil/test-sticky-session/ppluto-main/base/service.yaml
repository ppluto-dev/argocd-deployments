kind: Service
apiVersion: v1
metadata:
  name: ppluto-main-service-active
spec:
  selector:
    app: ppluto-main
  ports:
    - name: web-tickerbell # Client -- tickerbell.ai
      protocol: TCP
      port: 80
      targetPort: 5080

    - name: web-gaia # Client -- openembedding.com (Project Gaia)
      protocol: TCP
      port: 8003
      targetPort: 8003

    - name: web-projectpluto # Client -- www.projectpluto.co (Company website)
      protocol: TCP
      port: 8004
      targetPort: 8004

    - name: grpc # Node gRpc
      protocol: TCP
      port: 81
      targetPort: 81

    - name: grpc-web # Envoy for gRpc
      protocol: TCP
      port: 82
      targetPort: 82

    - name: auth # Auth (REST API)
      protocol: TCP
      port: 83
      targetPort: 83

---
kind: Service
apiVersion: v1
metadata:
  name: ppluto-main-service-preview
spec:
  selector:
    app: ppluto-main
  ports:
    - name: web-tickerbell # Client -- tickerbell.ai
      protocol: TCP
      port: 80
      targetPort: 5080

    - name: web-gaia # Client -- openembedding.com (Project Gaia)
      protocol: TCP
      port: 8003
      targetPort: 8003

    - name: web-projectpluto # Client -- www.projectpluto.co (Company website)
      protocol: TCP
      port: 8004
      targetPort: 8004

    - name: grpc # Node gRpc
      protocol: TCP
      port: 81
      targetPort: 81

    - name: grpc-web # Envoy for gRpc
      protocol: TCP
      port: 82
      targetPort: 82

    - name: auth # Auth (REST API)
      protocol: TCP
      port: 83
      targetPort: 83

---
kind: Service
apiVersion: v1
metadata:
  name: ppluto-main-misc-service
spec:
  selector:
    app: ppluto-main-misc
  ports:
    - name: misc
      protocol: TCP
      port: 5088
      targetPort: 5088
---
kind: Service
apiVersion: v1
metadata:
  name: open-embedding-api-service # to apply sticky session
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-target-group-attributes: stickiness.enabled=true, stickiness.lb_cookie.duration_seconds=600
spec:
  selector:
    app: ppluto-main
  ports:
    - name: grpc # Node gRpc
      protocol: TCP
      port: 81
      targetPort: 81
    - name: grpc-web # Envoy for gRpc
      protocol: TCP
      port: 82
      targetPort: 82
    - name: auth # Auth (REST API)
      protocol: TCP
      port: 83
      targetPort: 83
